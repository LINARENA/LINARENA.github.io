<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>CVE-2012-4782</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="shortcut icon" type="image/x-icon" href="https://linarena.com/favicon.ico" >
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="LIN ARENA Technology Blog" />
    <link rel="shortcut icon" href="/" type="image/png" />
    <link rel="canonical" href="/windows-0x0e" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="LIN ARENA" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="CVE-2012-4782" />
    <meta property="og:description" content="0x0e IE8 Exploit 안녕하세요. Joel입니다. 오늘은 지금까지 알아 본 기법을 토대로 exploit을 다루어 보고자 합니다. 2019년에 나온 CVE를 바로 다루어 보려고 하다가 차근차근 가보자는 생각으로 IE8부터 설명하기로 했답니다. 이번 블로그에서 연재하는 CVE-2012-4782는 IE8에서 발생하는 UAF 취약점입니다. Exodus 블로그를 많이 참조해서 글이 작성된 점을 먼저 안내 드립니다. 환경 구성 OS Windows" />
    <meta property="og:url" content="/windows-0x0e" />
    <meta property="og:image" content="/assets/images/windows/0x0e_6.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2019-07-22T03:00:00+09:00" />
    <meta property="article:modified_time" content="2019-07-22T03:00:00+09:00" />
    <meta property="article:tag" content="Posts" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="CVE-2012-4782" />
    <meta name="twitter:description" content="0x0e IE8 Exploit 안녕하세요. Joel입니다. 오늘은 지금까지 알아 본 기법을 토대로 exploit을 다루어 보고자 합니다. 2019년에 나온 CVE를 바로 다루어 보려고 하다가 차근차근 가보자는 생각으로 IE8부터 설명하기로 했답니다. 이번 블로그에서 연재하는 CVE-2012-4782는 IE8에서 발생하는 UAF 취약점입니다. Exodus 블로그를 많이 참조해서 글이 작성된 점을 먼저 안내 드립니다. 환경 구성 OS Windows" />
    <meta name="twitter:url" content="/" />
    <meta name="twitter:image" content="/assets/images/windows/0x0e_6.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="LIN ARENA" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Posts" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "LIN ARENA",
        "logo": "/"
    },
    "url": "/windows-0x0e",
    "image": {
        "@type": "ImageObject",
        "url": "/assets/images/windows/0x0e_6.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/windows-0x0e"
    },
    "description": "0x0e IE8 Exploit 안녕하세요. Joel입니다. 오늘은 지금까지 알아 본 기법을 토대로 exploit을 다루어 보고자 합니다. 2019년에 나온 CVE를 바로 다루어 보려고 하다가 차근차근 가보자는 생각으로 IE8부터 설명하기로 했답니다. 이번 블로그에서 연재하는 CVE-2012-4782는 IE8에서 발생하는 UAF 취약점입니다. Exodus 블로그를 많이 참조해서 글이 작성된 점을 먼저 안내 드립니다. 환경 구성 OS Windows"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="CVE-2012-4782" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://linarena.github.io/">LIN ARENA</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-Posts" role="menuitem"><a href="/tag/posts/">Posts</a></li>
    <!--<li class="nav-try-ghost" role="menuitem"><a href="https://ghost.org">Try Ghost</a></li>-->
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-windows ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="22 July 2019">22 July 2019</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/posts/'>POSTS</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">CVE-2012-4782</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/windows/0x0e_6.png)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <h1 id="0x0e-ie8-exploit">0x0e IE8 Exploit</h1>

<p>안녕하세요. Joel입니다.</p>

<p>오늘은 지금까지 알아 본 기법을 토대로 exploit을 다루어 보고자 합니다.</p>

<p>2019년에 나온 CVE를 바로 다루어 보려고 하다가 차근차근 가보자는 생각으로 IE8부터 설명하기로 했답니다.</p>

<p>이번 블로그에서 연재하는 CVE-2012-4782는 IE8에서 발생하는 UAF 취약점입니다.</p>

<p>Exodus 블로그를 많이 참조해서 글이 작성된 점을 먼저 안내 드립니다.</p>

<h5 id="환경-구성">환경 구성</h5>

<table>
  <tbody>
    <tr>
      <td>OS</td>
      <td>Windows XP Service Pack 3</td>
    </tr>
    <tr>
      <td>IE</td>
      <td>8.0.6001</td>
    </tr>
    <tr>
      <td>Affect Ver.</td>
      <td>IE6, IE7, IE8</td>
    </tr>
  </tbody>
</table>

<h5 id="poc">POC</h5>

<p>분석에 사용할 POC는 아래와 같습니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="kd">function</span> <span class="nx">helloWorld</span><span class="p">(){</span>
	<span class="kd">var</span> <span class="nx">e0</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
	<span class="kd">var</span> <span class="nx">e1</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
	<span class="kd">var</span> <span class="nx">e2</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
	
	<span class="k">try</span><span class="p">{</span>
		<span class="nx">e0</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"a"</span><span class="p">);</span>	<span class="c1">// form</span>
		<span class="nx">e1</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"b"</span><span class="p">);</span> <span class="c1">// dfn</span>
		<span class="nx">e2</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"q"</span><span class="p">);</span> <span class="c1">// q</span>
		<span class="nx">e1</span><span class="p">.</span><span class="nx">applyElement</span><span class="p">(</span><span class="nx">e2</span><span class="p">);</span>
		<span class="nx">e1</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'button'</span><span class="p">));</span>
		<span class="nx">e1</span><span class="p">.</span><span class="nx">applyElement</span><span class="p">(</span><span class="nx">e0</span><span class="p">);</span>
		<span class="nx">e2</span><span class="p">.</span><span class="nx">outerText</span><span class="o">=</span><span class="s2">""</span><span class="p">;</span>
		<span class="nx">e2</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'body'</span><span class="p">));</span>
		<span class="nx">CollectGarbage</span><span class="p">();</span>
	<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){}</span>

<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">"eval(helloWorld())"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">"a"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;/form&gt;</span>
	<span class="nt">&lt;dfn</span> <span class="na">id=</span><span class="s">"b"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;/dfn&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>위 코드를 실행하기 전에 아래 명령어로 몇 가지 설정을 해두고 분석을 하겠습니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gflag.exe /i iexplore.exe +hpa +ust
</code></pre></div></div>

<p>hpa : 페이지 힙 설정
ust : 유저 스택 트레이스 설정으로 유저모드의 스택 결과를 데이터베이스화하여 저장해두는 것</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_1.png" alt="[그림 1-1]" />
</figure>

<p>이제 windbg로 실행 결과를 보도록 하겠습니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_2.png" alt="[그림 1-2]" />
</figure>

<p>위 실행 결과를 보면 mshtml!CMarkup::OnLoadStatusDone+0x4ef에서 Access Violation Error가 발생하는 것을 알 수 있습니다.</p>

<p>에러 발생 이유를 추측해보면 move eax, dword ptr [edi]에서 edi 값에 문제가 있는 것 같습니다.</p>

<p>edi에 어떤 문제가 있어서 이런 에러가 발생하는지 살펴보겠습니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_3.png" alt="[그림 1-3]" />
</figure>

<p>첫 번째 빨간 박스에 CButton이라고 적혀 있는 것을 보면 edi는 Button 객체였다는 것을 알 수 있습니다.</p>

<p>그리고 vector deleting destructor를 보아 free된 객체인 것을 알 수 있습니다.</p>

<p>그리고 아래 CollectGarbage를 보면 더 확실해지네요.</p>

<p>CollectGarbage 함수에 의해 가장 윗줄 RtlFreeHeap까지 실행되어 오면서 Button 객체가 free된 것이라 생각할 수 있습니다.</p>

<p>객체가 해제된 뒤 그 객체에서 에러가 발생한다는 것은??</p>

<p>해제된 그 객체를 edi를 통해 다시 사용하려고 접근했기 때문이라고 추측할 수 있죠. 즉 여긴 UAF 취약점이 발생하는구나.</p>

<p>그럼 이제 CButton 객체가 생성되는 과정부터 해제하는 과정을 살펴보겠습니다.</p>

<p>먼저, CButton 생성 과정입니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_4.png" alt="[그림 1-4]" />
</figure>

<p>CButton은 CButton::CreateElement에서 HeapAlloc 함수를 이용해서 할당되는 것을 알 수 있습니다.</p>

<p>생성 시, 58h만큼 크기를 할당받는 것도 알 수 있네요.</p>

<p>그리고 HeapAlloc 함수가 끝난 뒤, 결과 값을 esi에 넣어주는 것도 알 수 있습니다.</p>

<p>다음은 CButton 객체를 해제하는 과정을 살펴볼게요.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_5.png" alt="[그림 1-5]" />
</figure>

<p>해제 과정에서는 esi의 값을 push하여 해당 객체를 해제한다는 것을 알 수 있습니다.</p>

<p>객체 생성 결과를 담은 esi와 해제 시에 사용한 esi가 같은 값인지는 조금 있다가 windbg로 살펴보겠습니다.</p>

<p>지금까지 우리는 CButton 객체의 생성과 해제 로직을 살펴봤습니다.</p>

<p>근데 에러 메시지를 보면 edi에서 에러가 발생하는데 이 edi는 갑자기 어디서 나오는 걸까요??</p>

<p>edi를 추적해보겠습니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_6.png" alt="[그림 1-6]" />
</figure>

<p>에러가 났던 OnLoadStatusDone 함수를 추적해본 결과, CElement::FindDefaultElem 함수에서 그 결과 값을 edi에 넣어준다는 것을 알 수 있습니다.</p>

<p>그럼 이제 CElement::FindDefaultElem을 살펴봐야겠죠?</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_7.png" alt="[그림 1-7]" />
</figure>

<p>코드를 따라가보면 CElement::Doc라는 함수의 결과를 edi에 넣어주고 있습니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_8.png" alt="[그림 1-8]" />
</figure>

<p>그리고 [edi+1A8h]를 eax에 넣어주고 난 뒤 CElement::FindDefaultElem가 종료됩니다.</p>

<p>왜 [edi+1A8h]에 해제된 CButton 객체가 있는지, CElement::Doc가 어떤 것을 반환하는지 알아봐야겠네요.</p>

<p>CElement::FindDefaultElem 시작 위치에 브레이크 포인트를 설정하고 코드를 따라가봤습니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_9.png" alt="[그림 1-9]" />
</figure>

<p>코드를 실행시키다보니 아까 위에서 살펴봤던 Doc가 보이고 결과 값이 eax에 들어가 있는 것도 보입니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_10.png" alt="[그림 1-10]" />
</figure>

<p>우리가 살펴보고자 했던 [edi+1A8h]까지 왔습니다.</p>

<p>아까 eax에 담겨 있던 값이 edi에 담겨 있고 또 vtable이라는 내용도 확인이 되네요.</p>

<p>그럼 저 [edi+1A8h]는 해제된 CButton 객체의 vtable 값이라는 것이라는 것도 알 수 있습니다.</p>

<p>이제 [edi+1A8h]에 CButton 객체의 vtable 값이 언제 쓰이는지만 파악하면 되겠습니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_11.png" alt="[그림 1-11]" />
</figure>

<p>위 그림처럼 mshtml!CDoc::operator new+0x00000013 부분에 브레이크를 설정하고 분석을 했습니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_15.png" alt="[그림 1-15]" />
</figure>

<p>코드를 쭉 따라가보면 위 그림과 같이 객체를 생성하는 부분을 확인할 수 있습니다.</p>

<p>이 결과 값 + 1A8h 위치에 값을 쓸 때 브레이크를 잡도록 설정해야겠네요.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_12.png" alt="[그림 1-12]" />
</figure>

<p>따라가보니 SetDefaultElem에서 eax+1A8h 위치에 값을 적는다는 것을 알 수 있습니다.</p>

<p>esi와 edi 값을 확인해보면 아래와 같습니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_13.png" alt="[그림 1-13]" />
</figure>

<figure>
  <img data-action="zoom" src="/assets/images/windows/0x0e_14.png" alt="[그림 1-14]" />
</figure>

<p>esi는 Cdoc이고 edi에 CButton 객체의 주소가 들어가 있는 것을 확인했습니다.</p>

<p>그런데 도대체 왜 SetDefaultElem에서 해제된 객체의 주소를 적어주는 걸까요??</p>

<p>Exodus 블로그에서는 SetDefaultElem에서 CDoc 객체에 레퍼런스를 추가하기전에 Addref를 호출하는 것을 잊어버린 것 같다라고 말하고 있습니다.</p>

<p>객체 참조시 Addref를 통해서 Count를 증가시키고 Release를 통해서 Count를 감소시키는데 0이 아니면 해제하지 않도록 되어 있습니다.</p>

<p>이런 경우, 균형이 맞지 않게 되어 원치 않게 객체가 해제되는 경우라고 볼 수 있겠습니다.</p>

<p>그래서 다른 레퍼런스를 제거하는 것으로 인해 객체가 해제되지만 Cdoc 객체에서 DefaultElem을 통해 계속 접근 가능한 것으로 판단됩니다.</p>

<hr />

<p>긴 글 읽으시느라 고생하셨습니다.</p>

<p>설명이 너무 길어져서 실제 공격은 다음 글로 넘겨서 진행하겠습니다.</p>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/CI_Logo.jpg" alt="Joel" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/Joel">Joel Park</a></h4>
                                
                                    <p>psh@linarena.com</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/Joel">Read More</a>
                        </div>
                    
                
                    
                
                    
                
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/lin_logo.png)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; LIN ARENA &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/posts/">Posts</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/linux_0x06">linux_0x06 Heap 구조(malloc, free)</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/windows-0x0d">Heap Spray</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/linux_0x05">linux_0x05 RTL Chaining & ROP</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/posts/">
                                
                                    See all 30 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/linux_0x06">
                <div class="post-card-image" style="background-image: url(/assets/images/linux/0x06/0x06-7.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/linux_0x06">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Posts</span>
                            
                        
                    

                    <h2 class="post-card-title">linux_0x06 Heap 구조(malloc, free)</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/CI_Logo.jpg" alt="Sulla" />
                        
                        <span class="post-card-author">
                            <a href="/author/Sulla/">Sulla</a>
                        </span>
                    
                
                    
                
                    
                
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="/">
            
            <span>LIN ARENA</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">CVE-2012-4782</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=CVE-2012-4782&amp;url=https://jekyller.github.io/jasper2/windows-0x0e"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://jekyller.github.io/jasper2/windows-0x0e"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="/">LIN ARENA</a> &copy; 2019</section>
                <section class="poweredby">All rights reserved. Powered by GitHub Pages.</section>
                <nav class="site-footer-nav">
                    <a href="/">[Latest Posts]</a>
                    <a href="https://linarena.com/" target="_blank" rel="noopener">[LIN ARENA HOMEPAGE]</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69281367-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
