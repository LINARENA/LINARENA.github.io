<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>web-0x02</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="shortcut icon" type="image/x-icon" href="https://linarena.com/favicon.ico" >
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="LIN ARENA Technology Blog" />
    <link rel="shortcut icon" href="http://localhost:4000/" type="image/png" />
    <link rel="canonical" href="http://localhost:4000/web-0x02" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="LIN ARENA" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="web-0x02" />
    <meta property="og:description" content="LFI to RCE on PHPMyAdmin 4.8.0 ~ 4.8.1 안녕하세요 hackyu입니다. 오늘은 CVE-2018-12613 PHPMyAdmin LFI to RCE 취약점에 대한 포스팅입니다. 해당 취약점은 PMA(PHP My Admin) 버전 4.8.0 ~ 4.8.1에서 발생하는 취약점이며, index.php 요청 시 사용되는 target 파라미터의 값이 조건을 만족하게되는 경우 include()를 통해 발생되는 LFI 취약점을 이용한 RCE 공격입니다. LFI /" />
    <meta property="og:url" content="http://localhost:4000/web-0x02" />
    <meta property="og:image" content="http://localhost:4000/assets/images/web/sky.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2019-03-11T04:00:00+09:00" />
    <meta property="article:modified_time" content="2019-03-11T04:00:00+09:00" />
    <meta property="article:tag" content="Posts" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="web-0x02" />
    <meta name="twitter:description" content="LFI to RCE on PHPMyAdmin 4.8.0 ~ 4.8.1 안녕하세요 hackyu입니다. 오늘은 CVE-2018-12613 PHPMyAdmin LFI to RCE 취약점에 대한 포스팅입니다. 해당 취약점은 PMA(PHP My Admin) 버전 4.8.0 ~ 4.8.1에서 발생하는 취약점이며, index.php 요청 시 사용되는 target 파라미터의 값이 조건을 만족하게되는 경우 include()를 통해 발생되는 LFI 취약점을 이용한 RCE 공격입니다. LFI /" />
    <meta name="twitter:url" content="http://localhost:4000/" />
    <meta name="twitter:image" content="http://localhost:4000/assets/images/web/sky.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="LIN ARENA" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Posts" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "LIN ARENA",
        "logo": "http://localhost:4000/"
    },
    "url": "http://localhost:4000/web-0x02",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:4000/assets/images/web/sky.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/web-0x02"
    },
    "description": "LFI to RCE on PHPMyAdmin 4.8.0 ~ 4.8.1 안녕하세요 hackyu입니다. 오늘은 CVE-2018-12613 PHPMyAdmin LFI to RCE 취약점에 대한 포스팅입니다. 해당 취약점은 PMA(PHP My Admin) 버전 4.8.0 ~ 4.8.1에서 발생하는 취약점이며, index.php 요청 시 사용되는 target 파라미터의 값이 조건을 만족하게되는 경우 include()를 통해 발생되는 LFI 취약점을 이용한 RCE 공격입니다. LFI /"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="web-0x02" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://linarena.github.io/">LIN ARENA</a>
            
        
        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-web ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="11 March 2019">11 March 2019</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/posts/'>POSTS</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">web-0x02</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/web/sky.jpg)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <h1 id="lfi-to-rce-on-phpmyadmin-480--481">LFI to RCE on PHPMyAdmin 4.8.0 ~ 4.8.1</h1>

<p>안녕하세요 hackyu입니다.</p>

<p>오늘은 CVE-2018-12613 PHPMyAdmin LFI to RCE 취약점에 대한 포스팅입니다.<br /><br /> 
해당 취약점은 PMA(PHP My Admin) 버전 4.8.0 ~ 4.8.1에서 발생하는 취약점이며, index.php 요청 시 사용되는 target 파라미터의 값이 조건을 만족하게되는 경우 include()를 통해 발생되는 LFI 취약점을 이용한 RCE 공격입니다.</p>

<h5 id="lfi--rce">LFI / RCE?</h5>

<p>LFI와 RCE 취약점에 대해 간략하게 설명드리겠습니다.<br /><br />
LFI(Local File Inclusion) 취약점이란 클라이언트에 의한 서버로의 요청 시 반환하는 응답의 결과 내에 서버 내 존재하는 파일이 포함되어 노출되는 취약점을 말합니다.<br /><br />
RCE(Remote Command Execution) 취약점이란 말그대로 원격 명령 실행으로 공격자가 삽입하는 또는 전달하는 값으로 서버 측의 환경에서 시스템 명령어를 실행할 수 있는 취약점을 말합니다.<br /></p>

<p>해당 취약점을 이해하기 위해서 세션에 대해서 간략하게 말씀드리자면, 서버가 클라이언트를 식별하는데 사용하는 일종의 별명이라고 생각하시면 될 것 같습니다. 또한, 일반적으로 세션은 서버 측에서 파일로 관리하게 됩니다.<br /><br />
세션이 파일로 관리되는 부분에 대해서는 본 포스팅의 뒷부분 취약점 분석 부분에서 간략히 확인하실 수 있으실 것 같습니다. 더불어 해당 취약점은 관리자로의 접근 이후 단계에서의 진행되는 것으로 생각하시면 될 것 같습니다.</p>

<h5 id="취약점-분석">취약점 분석</h5>
<ul>
  <li><strong>환경구성</strong><br />
    <ul>
      <li>Apache 2.4.18<br /></li>
      <li>PHP 7.0.30<br /></li>
      <li>PHPMyadmin 4.8.1<br /></li>
    </ul>
  </li>
</ul>

<figure>
  <img data-action="zoom" src="/assets/images/web/0x02_1.png" />
  <figcaption><center>  
   - LFI to RCE Vulnerability Flow -
  </center></figcaption>
</figure>
<p><br /></p>

<p>다음은 취약점이 발생한 PHPMyAdmin 4.8.1 소스코드 부분입니다.<br /></p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// phpmyadmin 4.8.1 index.php line 53 ~ 62
</span>
<span class="c1">// If we have a valid target, let's load that script instead 
</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'target'</span><span class="p">])</span>                            <span class="c1">// Request 시 target 파라미터 값 empty 야부
</span>    <span class="o">&amp;&amp;</span> <span class="nb">is_string</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'target'</span><span class="p">])</span>                       <span class="c1">// Request 요청 파라미터 target 값의 타입 문자열 여부
</span>    <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/^index/'</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'target'</span><span class="p">])</span>        <span class="c1">//Request 요청 파라미터 target값에 'index' 문자열 매칭 여부
</span>    <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="nb">in_array</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'target'</span><span class="p">],</span> <span class="nv">$target_blacklist</span><span class="p">)</span>   <span class="c1">// equest 요청 파라미터 target의 값이 blacklist에 속해 있는지 여부
</span>    <span class="o">&amp;&amp;</span> <span class="nx">Core</span><span class="o">::</span><span class="na">checkPageValidity</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'target'</span><span class="p">])</span>         <span class="c1">// Core 클래스의 checkPageValidity 함수의 인자로 호출 결과 여부
</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">include</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'target'</span><span class="p">];</span>                            <span class="c1">// 위의 조건이 만족하는 경우 include
</span>    <span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<figure>
  <figcaption><center>  
   - PHPMyAdmin 4.8.1 index.php line 53 to 62 -
  </center></figcaption>
</figure>
<p><br /></p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// whitelist of /phpmyadmin/libraries/Core.php
</span>
<span class="k">public</span> <span class="k">static</span> <span class="nv">$goto_whitelist</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'db_datadict.php'</span><span class="p">,</span>
    <span class="s1">'db_sql.php'</span><span class="p">,</span>
    <span class="s1">'db_events.php'</span><span class="p">,</span>
    <span class="s1">'db_export.php'</span><span class="p">,</span>        
    <span class="s1">'db_importdocsql.php'</span><span class="p">,</span>
    <span class="s1">'db_multi_table_query.php'</span><span class="p">,</span>
    <span class="s1">'db_structure.php'</span><span class="p">,</span>
    <span class="s1">'db_import.php'</span><span class="p">,</span>
    <span class="s1">'db_operations.php'</span><span class="p">,</span>
    <span class="s1">'db_search.php'</span><span class="p">,</span>
    <span class="s1">'db_routines.php'</span><span class="p">,</span>
    <span class="s1">'export.php'</span><span class="p">,</span>
    <span class="s1">'import.php'</span><span class="p">,</span>
    <span class="s1">'index.php'</span><span class="p">,</span>
    <span class="s1">'pdf_pages.php'</span><span class="p">,</span>
    <span class="s1">'pdf_schema.php'</span><span class="p">,</span>
    <span class="s1">'server_binlog.php'</span><span class="p">,</span>
    <span class="s1">'server_collations.php'</span><span class="p">,</span>
    <span class="s1">'server_databases.php'</span><span class="p">,</span>
    <span class="s1">'server_engines.php'</span><span class="p">,</span>
    <span class="s1">'server_export.php'</span><span class="p">,</span>
    <span class="s1">'server_import.php'</span><span class="p">,</span>
    <span class="s1">'server_privileges.php'</span><span class="p">,</span>
    <span class="s1">'server_sql.php'</span><span class="p">,</span>
    <span class="s1">'server_status.php'</span><span class="p">,</span>
    <span class="s1">'server_status_advisor.php'</span><span class="p">,</span>
    <span class="s1">'server_status_monitor.php'</span><span class="p">,</span>
    <span class="s1">'server_status_queries.php'</span><span class="p">,</span>
    <span class="s1">'server_status_variables.php'</span><span class="p">,</span>
    <span class="s1">'server_variables.php'</span><span class="p">,</span>
    <span class="s1">'sql.php'</span><span class="p">,</span>
    <span class="s1">'tbl_addfield.php'</span><span class="p">,</span>
    <span class="s1">'tbl_change.php'</span><span class="p">,</span>
    <span class="s1">'tbl_create.php'</span><span class="p">,</span>
    <span class="s1">'tbl_import.php'</span><span class="p">,</span>
    <span class="s1">'tbl_indexes.php'</span><span class="p">,</span>
    <span class="s1">'tbl_sql.php'</span><span class="p">,</span>
    <span class="s1">'tbl_export.php'</span><span class="p">,</span>
    <span class="s1">'tbl_operations.php'</span><span class="p">,</span>
    <span class="s1">'tbl_structure.php'</span><span class="p">,</span>
    <span class="s1">'tbl_relation.php'</span><span class="p">,</span>
    <span class="s1">'tbl_replace.php'</span><span class="p">,</span>
    <span class="s1">'tbl_row_action.php'</span><span class="p">,</span>
    <span class="s1">'tbl_select.php'</span><span class="p">,</span>
    <span class="s1">'tbl_zoom_select.php'</span><span class="p">,</span>
    <span class="s1">'transformation_overview.php'</span><span class="p">,</span>
    <span class="s1">'transformation_wrapper.php'</span><span class="p">,</span>
    <span class="s1">'user_password.php'</span><span class="p">,</span>
<span class="p">);</span>
</code></pre></div></div>

<figure>
  <figcaption><center>  
   - PHPMyAdmin 4.8.1 whitelist of phpmyadmin/libraries/Core.php -
  </center></figcaption>
</figure>
<p><br /></p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// checkPageValidity of /phpmyadmin/libraries/Core.php
</span>
<span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">checkPageValidity</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$page</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$whitelist</span> <span class="o">=</span> <span class="p">[])</span>
<span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$whitelist</span><span class="p">))</span> <span class="p">{</span>
       <span class="nv">$whitelist</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$goto_whitelist</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$page</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$page</span><span class="p">))</span> <span class="p">{</span>
       <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$page</span><span class="p">,</span> <span class="nv">$whitelist</span><span class="p">))</span> <span class="p">{</span>
       <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="nv">$_page</span> <span class="o">=</span> <span class="nb">mb_substr</span><span class="p">(</span>
       <span class="nv">$page</span><span class="p">,</span>
       <span class="mi">0</span><span class="p">,</span>
       <span class="nb">mb_strpos</span><span class="p">(</span><span class="nv">$page</span> <span class="o">.</span> <span class="s1">'?'</span><span class="p">,</span> <span class="s1">'?'</span><span class="p">)</span>
   <span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_page</span><span class="p">,</span> <span class="nv">$whitelist</span><span class="p">))</span> <span class="p">{</span>
       <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="nv">$_page</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$page</span><span class="p">);</span>   <span class="c1">// url decoding 
</span>   <span class="nv">$_page</span> <span class="o">=</span> <span class="nb">mb_substr</span><span class="p">(</span>
       <span class="nv">$_page</span><span class="p">,</span>
       <span class="mi">0</span><span class="p">,</span>
       <span class="nb">mb_strpos</span><span class="p">(</span><span class="nv">$_page</span> <span class="o">.</span> <span class="s1">'?'</span><span class="p">,</span> <span class="s1">'?'</span><span class="p">)</span>
   <span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_page</span><span class="p">,</span> <span class="nv">$whitelist</span><span class="p">))</span> <span class="p">{</span>
       <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<figure>
  <figcaption><center>  
   - PHPMyAdmin 4.8.1 checkPageValidity of phpmyadmin/libraries/Core.php -
  </center></figcaption>
</figure>
<p><br /></p>

<p>위 코드들이 해당 취약점에 발생되는 부분이며 간략하게 바로 드러나는 부분에 대해서는 주석처리로 설명하였습니다.<br /><br /> 
사용자가 입력한 값에 대한 검증에 미흡한 검증 절차가 있으며, checkPageValidity()에서 whitelist에 존재하는 값을 이용하여 db_sql.php?와 같이 bypass하기에 include() 함수를 이용하여 LFI가 가능한 것을 확인할 수 있습니다.</p>

<h5 id="취약점-공격-테스트">취약점 공격 테스트</h5>
<p>먼저 다음과 같이 현재 php 관련 정보를 확인할 수 있는 것을 알 수 있습니다. 또한, 이번 취약점을 분석하는데 있어 중요하게 봐야할 부분 중 하나인 기본 세션 저장 경로(session_save_path)를 확인할 수 있습니다.<br /><br />
현재 테스트 경로는 기본적으로 /var/lib/php/sessions라는 경로로 생성된 세션 파일이 저장되는 것으로 볼 수 있습니다.
<?php phpinfo(); ?></p>
<figure>
  <img data-action="zoom" src="/assets/images/web/0x02_2.png" />
  <figcaption><center>
   - phpinfo() 결과 -
</center></figcaption>
</figure>
<p><br /></p>

<p>phpmyadmin으로 로그인 한 이후, SQL문을 실행할 수 있는 부분에서 다음과 같이 입력 한 후 실행하겠습니다.</p>

<figure>
  <img data-action="zoom" src="/assets/images/web/0x02_3.png" />
  <figcaption><center>
   - SQL문 실행 시도 -
</center></figcaption>
</figure>
<p><br /></p>

<p>정상적으로 SQL문이 실행이 되고, 로그인 또는 페이지 접근 시 생성된 쿠키 정보 중 phpMyAdmin 세션 값을 확인할 수 있습니다.</p>
<figure>
  <img data-action="zoom" src="/assets/images/web/0x02_4.png" />
  <figcaption><center>
   - SQL문 실행 결과 확인 및 쿠키, 세션정보 확인 -
</center></figcaption>
</figure>
<p><br /></p>

<p>위에서 봤던 것과 같이 해당 경로에 이전단계에서 확인한 세션값 앞에 ‘sess_‘이라는 문자열이 연결된 세션 파일이 생성되고, 존재하는 것을 확인할 수 있습니다.</p>
<figure>
  <img data-action="zoom" src="/assets/images/web/0x02_5.png" />
  <figcaption><center>
   - 세션 파일 확인 -
</center></figcaption>
</figure>
<p><br /></p>

<p>해당 세션 파일의 내용을 확인해보면 앞서 실행하였던 SQL 쿼리문이 세션 파일 내용으로 포함된 것을 확인할 수 있습니다.</p>
<figure>
  <img data-action="zoom" src="/assets/images/web/0x02_6.png" />
  <figcaption><center>
   - 세션 파일 내용 확인 -
</center></figcaption>
</figure>
<p><br /></p>

<p>다음 그림과 같이 화이트리스트에 존재하는 목록(db_sql.php) 이용한 index.php의 파라미터 target으로 사용하며, 추가적으로 파일다운로드 취약점을 이용한 공격 시 많이 알려지고 사용되는 상대경로 ex) ../../../ 를 이용하여 세션저장경로의 세션파일 연결하여 파라미터 값으로 요청한 결과입니다.<br /><br />
본 그림에서 보이는 것과 같이 앞서 실행한 SQL문이 포함되어 phpinfo()가 정상적으로 동작된 결과가 LFI를 통해 확인할 수 있습니다.</p>
<figure>
  <img data-action="zoom" src="/assets/images/web/0x02_7.png" />
  <figcaption><center>
   - LFI 시도 및 결과 -
</center></figcaption>
</figure>
<p><br /></p>

<p>지금까지 입력한 SQL문이 세션 파일 내 포함이 되며 정상적으로 실행된 결과를 LFI를 통해 확인할 수 있는 부분까지 진행하였습니다.<br /><br /> 본격적인 RCE를 위해 다음과 같이 SQL문을 실행하여 세션파일 내 포함하도록 합니다. 본 SQL문에 포함되는 php구문에 시스템 명렁어를 실행하는 함수 중 system() 함수를 이용하였습니다.</p>
<figure>
  <img data-action="zoom" src="/assets/images/web/0x02_8.png" />
  <figcaption><center>
   - 세션 파일 내용 확인 -
</center></figcaption>
</figure>
<p><br /></p>

<p>다음 그림으로 정상적으로 RCE가 가능한 것을 확인할 수 있습니다. 앞에서 수행했던 방식과 조금의 차이점은 파라미터를 포함하여 요청 하였습니다. cmd라는 파라미터로 입력한 시스템 명령어가 정상적으로 실행되는 것을 확인할 수 있습니다.</p>
<figure>
  <img data-action="zoom" src="/assets/images/web/0x02_9.png" />
  <figcaption><center>
   - RCE 시도 및 결과 (id) -
</center></figcaption>
</figure>
<p><br /></p>

<figure>
  <img data-action="zoom" src="/assets/images/web/0x02_10.png" />
  <figcaption><center>
   - RCE 시도 및 결과 (cat /etc/passwd) -
</center></figcaption>
</figure>
<p><br /></p>

<p>취약점 분석한 결과를 요약하면 다음과 같습니다.<br /><br />
사용자가 실행한 SQL문이 세션 파일 내 포함됨<br />
Whitelist 값을 이용한 index.php의 target 파라미터로 요청 시 LFI 취약점 확인<br />
LFI를 이용한 원활한 RCE 사용 가능<br /><br /></p>

<ul>
  <li><strong>패치 및 대응방안</strong>
<br />
 https://www.phpmyadmin.net/files/4.8.2/ 를 통해 본 취약점과 타 취약점들에 대해서 패치가 된 버전인 4.8.2로 업데이트 된 것을 확인할 수 있습니다.<br /><br />
 ./phpmyadmin/libraries/classes/Core.php의 checkPageValidity()와 index.php의 checkPageValidity 호출 시 사용되는 파라미터 부분이 변경된 것을 확인하였습니다.
<br /><br /></li>
  <li><strong>References</strong>
<br />
https://blog.vulnspy.com/2018/06/21/phpMyAdmin-4-8-x-Authorited-CLI-to-RCE/<br />
https://www.vulnspy.com/phpmyadmin-4.8.1/<br />
https://medium.com/@happyholic1203/phpmyadmin-4-8-0-4-8-1-remote-code-execution-257bcc146f8e<br />
https://www.youtube.com/watch?v=bT-00ZUTq0o</li>
</ul>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                
                    
                
                    
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/CI_Logo.jpg" alt="Hackyu" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/Hackyu">Hackyu</a></h4>
                                
                                    <p>ldk@linarena.com</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/Hackyu">Read More</a>
                        </div>
                    
                
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/lin_logo.png)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; LIN ARENA &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/posts/">Posts</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/windows-0x09">windows-0x09</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/runC-Container">CVE-2019-5736 (runC Container 취약점)</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/linux_0x04">linux_0x04</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/posts/">
                                
                                    See all 20 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/linux_0x03">
                <div class="post-card-image" style="background-image: url(/assets/images/linux/0x03/0x03-9.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/linux_0x03">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Posts</span>
                            
                        
                    

                    <h2 class="post-card-title">linux_0x03</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/CI_Logo.jpg" alt="Sulla" />
                        
                        <span class="post-card-author">
                            <a href="/author/Sulla/">Sulla</a>
                        </span>
                    
                
                    
                
                    
                
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/windows-0x05">
                <div class="post-card-image" style="background-image: url(/assets/images/windows/test.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/windows-0x05">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Posts</span>
                            
                        
                    

                    <h2 class="post-card-title">windows-0x05</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/CI_Logo.jpg" alt="Joel Park" />
                        
                        <span class="post-card-author">
                            <a href="/author/Joel/">Joel Park</a>
                        </span>
                    
                
                    
                
                    
                
                    
                
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="http://localhost:4000/">
            
            <span>LIN ARENA</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">web-0x02</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=web-0x02&amp;url=https://jekyller.github.io/jasper2/web-0x02"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://jekyller.github.io/jasper2/web-0x02"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="http://localhost:4000/">LIN ARENA</a> &copy; 2019</section>
                <section class="poweredby">All rights reserved. Powered by GitHub Pages.</section>
                <nav class="site-footer-nav">
                    <a href="/">[Latest Posts]</a>
                    <a href="https://linarena.com/" target="_blank" rel="noopener">[LIN ARENA HOMEPAGE]</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69281367-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
